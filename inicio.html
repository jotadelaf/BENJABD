<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Empleados</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Sistema de Empleados</h1>
        
        <!-- Navegación -->
        <nav class="nav-tabs">
            <button class="nav-btn active" onclick="showForm('registrar')">Registrar</button>
            <button class="nav-btn" onclick="showForm('modificar')">Modificar</button>
            <button class="nav-btn" onclick="showForm('eliminar')">Eliminar</button>
            <button class="nav-btn" onclick="showForm('listar1')">Listar 1</button>
            <button class="nav-btn" onclick="showForm('listar2')">Listar 2</button>
            <button class="nav-btn" onclick="window.location.href='ver_respaldos.php'">Respaldos</button>
        </nav>

        <!-- Formulario Registrar Empleado -->
        <div id="registrar" class="form-section active">
            <h2>Registrar Empleado</h2>
            <form action="insertar.php" method="post">
                <div class="form-group">
                    <label for="nombre">Nombre:</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>

                <div class="form-group">
                    <label for="apellido">Apellido:</label>
                    <input type="text" id="apellido" name="apellido" required>
                </div>

                <div class="form-group">
                    <label for="sexo">Sexo:</label>
                    <select id="sexo" name="sexo" required>
                        <option value="">Seleccione</option>
                        <option value="Masculino">Masculino</option>
                        <option value="Femenino">Femenino</option>
                        <option value="Otro">Otro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="sueldo">Sueldo:</label>
                    <input type="number" id="sueldo" name="sueldo" step="0.01" min="0" required>
                </div>

                <button type="submit" class="btn-submit">Registrar Empleado</button>
            </form>
        </div>

        <!-- Formulario Modificar Empleado -->
        <div id="modificar" class="form-section">
            <h2>Modificar Empleado</h2>
            <form action="actualizar.php" method="post">
                <div class="form-group">
                    <label for="campo_modificar">Campo a Modificar:</label>
                    <select id="campo_modificar" name="campo_modificar" required>
                        <option value="">Seleccione campo</option>
                        <option value="nombre">Nombre</option>
                        <option value="apellido">Apellido</option>
                        <option value="sexo">Sexo</option>
                        <option value="sueldo">Sueldo</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="nuevo_valor">Nuevo Valor:</label>
                    <input type="text" id="nuevo_valor" name="nuevo_valor" required>
                </div>

                <div class="form-group">
                    <label for="condicion_campo">Condición (Campo):</label>
                    <select id="condicion_campo" name="condicion_campo" required>
                        <option value="">Seleccione campo</option>
                        <option value="nombre">Nombre</option>
                        <option value="apellido">Apellido</option>
                        <option value="sexo">Sexo</option>
                        <option value="sueldo">Sueldo</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="condicion_valor">Condición (Valor):</label>
                    <input type="text" id="condicion_valor" name="condicion_valor" required>
                </div>

                <button type="submit" class="btn-submit">Modificar Empleado</button>
            </form>
        </div>

        <!-- Formulario Eliminar Empleado -->
        <div id="eliminar" class="form-section">
            <h2>Eliminar Empleado</h2>
            <form action="eliminar.php" method="post">
                <div class="form-group">
                    <label for="campo_eliminar">Campo de Condición:</label>
                    <select id="campo_eliminar" name="campo_eliminar" required>
                        <option value="">Seleccione campo</option>
                        <option value="nombre">Nombre</option>
                        <option value="apellido">Apellido</option>
                        <option value="sexo">Sexo</option>
                        <option value="sueldo">Sueldo</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="valor_eliminar">Valor de Condición:</label>
                    <input type="text" id="valor_eliminar" name="valor_eliminar" required>
                </div>

                <button type="submit" class="btn-submit btn-danger">Eliminar Empleado</button>
            </form>
        </div>

        <!-- Formulario Listar Empleados 1 -->
        <div id="listar1" class="form-section">
            <div id="lista-empleados-todos" class="empleados-lista">
                <!-- Los empleados se cargarán aquí automáticamente -->
            </div>
        </div>

        <!-- Formulario Listar Empleados 2 -->
        <div id="listar2" class="form-section">
            <div class="form-group">
                <label for="filtro_sexo">Filtrar por Sexo:</label>
                <select id="filtro_sexo" name="filtro_sexo">
                    <option value="">Seleccione sexo</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Femenino">Femenino</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>
            <div id="lista-empleados-filtrados" class="empleados-lista">
                <!-- Los empleados filtrados se mostrarán aquí -->
            </div>
        </div>
    </div>

    <script>
        function showForm(formId) {
            // Ocultar todos los formularios
            const forms = document.querySelectorAll('.form-section');
            forms.forEach(form => form.classList.remove('active'));
            
            // Mostrar el formulario seleccionado
            document.getElementById(formId).classList.add('active');
            
            // Actualizar botones de navegación
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Cargar empleados automáticamente según el formulario
            if (formId === 'listar1') {
                cargarTodosLosEmpleados();
            } else if (formId === 'listar2') {
                cargarEmpleadosFiltrados();
            }
        }

        // Funciones para cargar empleados
        function cargarTodosLosEmpleados() {
            const listaContainer = document.getElementById('lista-empleados-todos');
            if (!listaContainer) {
                return;
            }

            // Mostrar indicador de carga
            listaContainer.innerHTML = '<div class="no-resultados">Cargando empleados...</div>';

            // Usar fetch para la petición AJAX
            const formData = new FormData();
            formData.append('action', 'listar_todos');

            fetch('listar1.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                listaContainer.innerHTML = data;
            })
            .catch(error => {
                console.error('Error al cargar empleados:', error);
                listaContainer.innerHTML = '<div class="no-resultados">Error al cargar los empleados</div>';
            });
        }

        function cargarEmpleadosFiltrados() {
            const filtroSexo = document.getElementById('filtro_sexo').value;
            const listaContainer = document.getElementById('lista-empleados-filtrados');
            if (!listaContainer) {
                return;
            }

            // Si no hay filtro seleccionado, limpiar la lista
            if (!filtroSexo || filtroSexo === '') {
                listaContainer.innerHTML = '';
                return;
            }

            // Mostrar indicador de carga
            listaContainer.innerHTML = '<div class="no-resultados">Cargando empleados...</div>';

            // Usar fetch para la petición AJAX
            const formData = new FormData();
            formData.append('action', 'listar_filtrados');
            formData.append('filtro_sexo', filtroSexo);

            fetch('listar2.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                listaContainer.innerHTML = data;
            })
            .catch(error => {
                console.error('Error al cargar empleados filtrados:', error);
                listaContainer.innerHTML = '<div class="no-resultados">Error al cargar los empleados</div>';
            });
        }

        // Evento para el filtro por sexo
        document.addEventListener('DOMContentLoaded', function() {
            const filtroSexo = document.getElementById('filtro_sexo');
            if (filtroSexo) {
                filtroSexo.addEventListener('change', function() {
                    cargarEmpleadosFiltrados();
                });
            }
        });
    </script>
</body>
</html>
